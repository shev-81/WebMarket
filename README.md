<h1 align="center">Интернет магазин. 
<h3 align="center"> на микросервисной архитектуре - Spring Boot, REST, Docker, Kafka</h3>

<a href="https://shev-81.github.io/WebMarket/"><img src="https://img.shields.io/badge/WebMarket-JavaDoc-green"/>  </a>

## 0. Предисловие 
Проект написан, в рамках изучения мной `REST` архитектуры взаимодействия между микросервисами, и я решил создать собственный интернет магазин продуктов (в качестве продуктов можно рассматривать все что угодно, это всего лиш вопрос расширения функционала). Мной рассматривалось два варианта реализации архитектуры. 
 
 - Первый вариант, это использование `Eureca от Netflix` в качестве `Discovery service` и `Rabbit MQ` в качестве брокера сообщений между сервисами.
 
 - Второй вариант, это работать с настроенным вручную `Gate Way`, где определить маршрутизацию для каждого микросервиса за ним и использовать Kafka как брокер сообщения между сервисами. Я выбрал - работать с `Gate Way` и `Kafka`, пример горизонтально маштабируемой структыры проекта с `Eureca Netflix` и `Rabbit MQ` можно увидеть в другом моем реопзитарии.
 
> <b>Техническая часть</b>
 - `IDE: IntelliJ IDEA 2021.3.3`
 - `Версия JDK: 17.0.1 .`
 - `Apache Kafka`
 - `Postgresql`, `MySql`, `Redis`
 - `Docker`, `FlyWay`
 - `Spring framework`
> <b>Используемые технологии:</b>
 - `Java`
 - `Spring Boot`, `Hibernate`, `Data Jpa`, `Paypal sdk` 
 - `Angular JS`, `HTML`, `Bootstrap`, `CSS`
 - `Spring Cloud`, `Feign client`, `Web client`, `Discovery service - GateWay`
 - `Java Doc`, `Swager`
 - `Lombok`
 - `SOAP` 
 - `Stream API`
 - `Мавен 3.5`

В проекте использованы несколько баз данных `MySQL`, `Postgres`, `Redis`. Имеет единую точку входа через GateWay с настроеной маршрутизацией, а фронте настроена маршрутизация для перемещения пользователей на JS. Общая архитектура проекта представлена ниже на схеме.

![schema_project](https://user-images.githubusercontent.com/89448563/192151653-d168536e-62fc-4223-9bd5-e1b7ac2d3d77.png)

> В проекте магазина реализован основной функционал для покупки товаров: 
Добавить товар в корзину -> Cформировать заказ -> Оплатить заказ через PayPal.


## 1. Front Service (Фронт магазина)
Работает с фронтом всех разделов магазина, маршрутизирует перемещение пользователя. Этот сервис включает в себя все страницы html
по всем разделам магазина, а так же файлы скриптов на `Angular JS` для этих страниц. 

> Вид каталога товаров на фронте.

![prodaction](https://user-images.githubusercontent.com/89448563/192355576-12da5359-538a-4825-a812-ca198f8080d3.png)

> Для ускорения разработки были использованы стили `CSS Bootstrap`, которые позволили не отрисовывать графические элементы дизайна, а взять и использовать готовые.

В каталоге товаров на фронте реализована пагинация и фильтр по категориям товаров. Товар из каталога можно добавить в корзину. Корзина для каждого пользователя своя,
что не исключает ее использование не авторизованным пользователем, для этого ему будет создана временная корзина. Положив товары в корзину из каталога тоаваров, в разделе `Корзина` будут показаны все выбранные товары и перерасчитаны в соотвветствии со стоимостью и количеством. Корзина позволяет продолжить процесс оформления выбранных товаров и создать `Заказ`. Создав заказ и введя детальные данные о доставке, можно сразу же его оплатить он-лайн при помощи платежной системы `PayPal`. 

> Платежная система `PayPal`, подключена в режиме песочницы, но от реално проводимых платежей отделяет всего лишь настроенный профиль в личном кабинеет  платежной системы и включение опции проводить реальные платежи.  

И наконец проведя оплату статус заказа поменятся на - ОПЛАЧЕН. 

![orders](https://user-images.githubusercontent.com/89448563/193060389-8c24445f-1d5c-4b9a-81db-15c706f899ca.png)

## 2. Auth Service (Сервис Авторизации)
Содержит в себе Модуль безопасности выдающий токены прошедшим авторизацию пользователям. Использует для своей работы Базу 
данных Postgres, для хранения информации о пользователях магазина. Пользователь получивший `JWT` - `Java Web Token`, сохраняет его на фронте и использует его для получения доступа к закрытым разделам сайта. Если токен отсутствует или его срок годности истек, потребуется по новой пройти процедуру его получения.

## 3. Cart Service (Сервис корзины)
Реализует функционал корзины пользователя, получает и сохраняет список товаров в объект корзины, затем сохраняет его в БД Redis.
В алгоритме корзины реализован перерасчет добавляемых одинаковых позиций товаров. При запросе из MS Core Service, отдает этот 
объект для формирования заказа.

## 4. Core Service (Сервис Ядро магазина)
Работает с товарами и их категориями, заказами пользователей и взаимодействием с платежной системой PayPal. 
В сервисе настроена интеграция с корзиной пользователя (MS Cart Service), а так же с PayPal. Реализованн SOAP API для получения
списка товаров и списка категорий товаров. Общение межу сервисами через Web Client. Данные о товарах и заказах хранятся в 
БД Postgres.

## 5. Analityc Service (Сервис Аналитики)
Запрашивает данные у MS Core Service,  и сохраняет их в БД MySQL.  Данные запрашиваются каждые 10 секунд и содержат в себе 
названия продуктов, наиболее часто добавляемых в корзины покупателей. При загрузке стартовой страницы магазина,  данные 
показываются в виде списка востребованных товаров.

## 6. GateWay Service (BackEnd маршрутизация между сервисами магазина)
Настроена маршрутизация по MS магазина с проверкой валидности доступа.

## 7. Docker 
Для разворачивания окружжения через докер необходимо запустить файл: /flayway/start-migration.bat 
Он развернет несколько образов в Docker необходимых для работы (MySQL, Postgress, Redis), а так же запустит скрипты для миграции.
